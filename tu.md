### Web-Администратор: список задач

#### Управление задачами через механизм upgrade

##### Внутренний формат json-файла команд: описание

```json
[{
    "action":"insert",
    "caption":"админ: Установить Upgrade (Обновление)",
    "path":"/usr/appserv/bin/upgrade.sh",
    "isPacketable":0,
    "idTypeTask":99,
    "comment":null,
    "param":[],
    "bind":["admin","byt","chief","prom"]
  },{
    "action":"insert",
    "caption":"быт: Закрытие дня/месяца",
    "path":"~/bin/closeday.sh",
    "isPacketable":1,
    "idTypeTask":2,
    "comment":null,
    "param":[{
        "caption":"База данных",
        "ftCmdParam":"ftBaseName",
        "maxLength":null,
        "prompt":null
      },{
        "caption":"AppHome",
        "ftCmdParam":"ftAppHome",
        "maxLength":null,
        "prompt":null
      },{
        "caption":"Пересчитать всех абонентов",
        "ftCmdParam":"ftBoolean",
        "maxLength":null,
        "prompt":null
      }],
    "bind":["byt"]
  },{
    "action":"insert",
    "caption":"пром: Синхронизация данных с Мегабиллингом",
    "path":"~/bin/inhab2bl.sh",
    "isPacketable":1,
    "idTypeTask":2,
    "comment":null,
    "param":[{
        "caption":"AppHome",
        "ftCmdParam":"ftAppHome",
        "maxLength":null,
        "prompt":null
      },{
        "caption":"База данных прома",
        "ftCmdParam":"ftBaseName",
        "maxLength":null,
        "prompt":null
      }],
    "bind":["prom"]
  }]
```

##### Предназначение ключей и допустимые значения

* **action** - действие над задачей\
тип значения: *строка*\
допустимые значения:\
`insert | delete | rename | erase | delete_all | erase_all`
* **caption** - название задачи\
тип значения: *строка*\
допустимые значения: название задачи должно быть *уникальным*, не должно быть разных задач с одинаковым названием
* **path** - путь к исполняемому файлу задачи\
тип значения: *строка*\
допустимые значения: абсолютный путь или относительный, относительно папки приложения, которая обозначается знаком **~** *тильда*
* **isPacketable** - задача может работать в составе пакета задач?\
тип значения: *число*\
допустимые значения: 1 - да, 0 - нет
* **idTypeTask** - тип задачи\
тип значения: *число*\
допустимые значения: 1 - Администрирование, 2 - Прикладные, 99 - Обновление
* **comment** - комментарий к задаче\
тип значения: *строка* или *null*\
допустимые значения: не пустая строка, желательно без ведущих и хвостовых пробелов, или *null* как признак отсутствия комментария
* **bind** - привязка задачи ко всем приложениям определенного типа\
тип значения: *массив строк*\
допустимые значения:\
`["admin","byt","chief","defence","gas","prom","prom_blob","stock","water"]`\
возможна любая комбинация типов приложений, в т.ч. и пустой массив []\
в случае [] привязка задачи к приложениям не производится
* **param** - список параметров задачи\
тип значения: *массив объектов*\
допустимые значения: перечень объектов *"Параметр задачи"* или пустой массив [] когда параметров у задачи *нет*

##### Объект "Параметр задачи" как элемент массива param

* **caption** - название параметра\
тип значения: *строка*\
допустимые значения: не пустая строка, желательно без ведущих и хвостовых пробелов
* **ftCmdParam** - тип параметра\
тип значения: *строка*\
допустимые значения:\

`ftServer | ftBaseName | ftAppHome | ftString | ftInteger | ftBoolean | ftConst | ftBaseShortName | ftDateTime | ftDate | ftFile | ftAppName | ftFloat | ftTime`
> тип параметра ftServer как имя сервера, сейчас в задачах не используется, зарезервированно под мультисерверные конфигурации

* **maxLength** - максимально допустимая длина значения параметра в символах, обычно используется для ограничения длины строковых параметров в полях ввода\
тип значения: *число* или *null*\
допустимые значения: целое число >0 или *null* как признак отсутствия ограничения на длину
* **prompt** - значение параметра по умолчанию\
тип значения: *строка* или *null*\
допустимые значения: не пустая строка, желательно без ведущих и хвостовых пробелов, или *null* как признак отсутствия значения по умолчанию
